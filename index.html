<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1, viewport-fit=cover, user-scalable=no" />
  <title>ระบบสต็อกวัสดุ</title>
  <link rel="icon" type="image/png" href="favicon.png" />

  <!-- === Liquid Glass UI Styling + Animations === -->
  <style>
    :root{
      --fs-xs: clamp(0.78rem, 1.3vw, 0.9rem);
      --fs-sm: clamp(0.95rem, 1.6vw, 1.05rem);
      --fs-md: clamp(1.05rem, 2vw, 1.2rem);
      --fs-lg: clamp(1.2rem, 2.4vw, 1.4rem);
      --space-1:.5rem; --space-2:.75rem; --space-3:1rem;
      --radius: 1rem; --border: rgba(255,255,255,.35);
      --bg:#eef1f6; --card: rgba(255,255,255,0.6); --text:#0b0b0d;
      --accent:#0a84ff; --shadow: 0 10px 30px rgba(0,0,0,.08);
    }

    html,body{height:100%}
    body{
      margin:0; min-height:100vh;
      font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
      background:linear-gradient(180deg,#eaf0ff 0%,#f7f9ff 100%);
      color:var(--text);
    }

    .glass{
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      backdrop-filter: saturate(160%) blur(12px);
      -webkit-backdrop-filter: saturate(160%) blur(12px);
    }

    .tabs{
      display:flex; gap:.5rem; padding:.4rem; overflow:auto;
      border-radius:9999px; background:rgba(255,255,255,0.55);
      border:1px solid rgba(255,255,255,.45);
      animation: fadeSlide .45s ease-out both;
    }
    .tabs button{
      flex:0 0 auto; white-space:nowrap; padding:.6rem .9rem; border:none;
      border-radius:9999px; background:transparent; cursor:pointer; font-weight:800;
      color:#1e1e20; font-size:var(--fs-sm);
      transition: transform .12s ease, background-color .2s ease, color .2s ease;
    }
    .tabs button:hover{ transform: translateY(-1px) }
    .tabs button:active{ transform: translateY(0) scale(.98) }
    .tabs button.active{ background:#fff; color:#0a84ff; box-shadow:var(--shadow) }

    .card{ padding:var(--space-3); display:flex; flex-direction:column; gap:var(--space-3) }
    .row{ display:flex; flex-wrap:wrap; gap:var(--space-3) }
    .row > *{ flex:1 1 14rem }

    input,select{
      width:100%; padding:.95rem 1rem; font-size:16px;
      border-radius:.9rem; border:1px solid rgba(255,255,255,.7);
      background:rgba(255,255,255,.92);
      backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px);
      box-shadow: inset 0 0 0 1px rgba(255,255,255,.3);
      transition: box-shadow .2s ease, border-color .2s ease, background-color .2s ease;
    }
    input:focus,select:focus{
      border-color:#0a84ff;
      box-shadow:0 0 0 .25rem rgba(10,132,255,.2);
      outline:none;
    }

    /* Toolbar — centered glass pill with entrance animation */
    .toolbar{
      position:fixed; left:50%; transform:translateX(-50%);
      bottom:max(1rem, env(safe-area-inset-bottom)); z-index:40;
      width:min(92vw, 720px);
      display:flex; justify-content:center; align-items:center; gap:.55rem;
      padding:.6rem .9rem;
      background:rgba(255,255,255,0.55);
      border:1px solid rgba(255,255,255,0.55);
      border-radius:9999px;
      box-shadow:0 20px 40px rgba(0,0,0,.16), inset 0 0 0 1px rgba(255,255,255,.3);
      backdrop-filter: blur(22px) saturate(180%);
      -webkit-backdrop-filter: blur(22px) saturate(180%);
      animation: slideUpSoft .5s cubic-bezier(.2,.7,.2,1) .08s both;
    }

    .btn{
      appearance:none; cursor:pointer; font-weight:800; font-size:var(--fs-sm);
      padding:.85rem 1rem; border-radius:.9rem;
      border:1px solid rgba(255,255,255,.45);
      background:rgba(255,255,255,0.55); color:#111;
      box-shadow:inset 0 0 0 1px rgba(255,255,255,.6), 0 3px 8px rgba(0,0,0,.08);
      -webkit-tap-highlight-color:transparent;
      transition: transform .12s ease, box-shadow .2s ease, background-color .2s ease;
    }
    .btn:hover{ transform: translateY(-1px) }
    .btn:active{ transform: translateY(0) scale(.98) }
    .btn.primary{
      color:#fff; border-color:transparent;
      background:linear-gradient(145deg,#0a84ff,#4da3ff);
      box-shadow:0 6px 14px rgba(10,132,255,.28), inset 0 0 0 1px rgba(255,255,255,.2)
    }
    .btn.small{ padding:.45rem .75rem; font-size:var(--fs-xs); background:rgba(255,255,255,0.5) }

    #pickerOverlay{
      position:fixed; inset:0; z-index:2000; display:none;
      align-items:center; justify-content:center;
      background:rgba(15,18,23,0.35);
      backdrop-filter: blur(3px);
    }
    #pickerOverlay.open{ display:flex; animation: fadeIn .18s ease-out both; }

    #pickerBox{
      background:rgba(255,255,255,.7);
      border:1px solid rgba(255,255,255,.45);
      border-radius:16px;
      box-shadow:0 20px 50px rgba(0,0,0,.18);
      display:flex; flex-direction:column;
      width:100%; height:100%; overflow:hidden;
      backdrop-filter: blur(12px);
      animation: glassPop .22s ease-out both;
    }
    .picker-header{
      display:flex; gap:.5rem; align-items:center;
      padding:.75rem; border-bottom:1px solid rgba(255,255,255,.4);
      background:rgba(255,255,255,.55);
    }
    .picker-list{
      flex:1; overflow:auto; padding:.6rem .75rem; display:flex; flex-direction:column; gap:.5rem;
      background:rgba(255,255,255,.4);
      animation: fadeSlide .3s ease-out both;
    }
    .picker-actions{
      border-top:1px solid rgba(255,255,255,.4);
      padding:.6rem .75rem;
      background:rgba(255,255,255,.55);
      display:flex; justify-content:center; align-items:center;
    }
    .picker-actions .btn{ min-width:220px; text-align:center }
    @media (max-width:480px){ .picker-actions .btn{ width:100%; min-width:0 } }

    .toast{
      position:fixed; left:50%; bottom:calc(env(safe-area-inset-bottom) + 4.6rem);
      transform:translateX(-50%); background:#111; color:#fff;
      padding:.7rem 1rem; border-radius:.9rem; display:none; z-index:2500; font-size:var(--fs-sm);
      box-shadow:0 12px 30px rgba(0,0,0,.16);
    }
    .toast.show{ display:block; animation: fadeIn .18s ease-out both }

    .skeleton{
      position:relative; overflow:hidden; border-radius:.7rem; background:rgba(255,255,255,.55); min-height:2.4rem;
      border:1px solid rgba(255,255,255,.5);
    }
    .skeleton::after{
      content:""; position:absolute; inset:0;
      background:linear-gradient(90deg, transparent 0%, rgba(255,255,255,.7) 50%, transparent 100%);
      animation: shimmer 1.1s infinite;
    }

    .dash-grid{ display:grid; gap:.75rem }
    @media (min-width:900px){
      .dash-grid{ grid-template-columns: 1fr 1fr; align-items:start }
      .dash-span-2{ grid-column: span 2 }
    }
    .dash-grid > .card{ animation: fadeSlide .42s ease-out both }
    .dash-grid > .card:nth-child(1){ animation-delay:.02s }
    .dash-grid > .card:nth-child(2){ animation-delay:.06s }
    .dash-grid > .card:nth-child(3){ animation-delay:.1s }
    .dash-grid > .card:nth-child(4){ animation-delay:.14s }
    .dash-grid > .card:nth-child(5){ animation-delay:.18s }
    .dash-grid > .card:nth-child(6){ animation-delay:.22s }

    @keyframes fadeIn { from{opacity:0} to{opacity:1} }
    @keyframes fadeSlide { from{opacity:0; transform: translateY(8px) scale(.98)} to{opacity:1; transform:none} }
    @keyframes slideUpSoft { from{opacity:.001; transform: translate(-50%, 10px)} to{opacity:1; transform: translate(-50%, 0)} }
    @keyframes glassPop { from{opacity:0; transform: translateY(6px) scale(.98)} to{opacity:1; transform: none} }
    @keyframes shimmer { 0%{transform:translateX(-100%)} 100%{transform:translateX(100%)} }

    @media (prefers-reduced-motion: reduce){
      *{ animation-duration:.001ms !important; animation-iteration-count:1 !important; transition:none !important }
    }

    /* ===== Safe-boot helpers ===== */
    #boot-error{
      position:fixed; inset:0; z-index:9999; display:none;
      background: rgba(0,0,0,.45); backdrop-filter: blur(6px);
      color:#fff; padding:16px; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
    }
    #boot-error .box{
      max-width:760px; margin:10vh auto 0; border-radius:14px; padding:16px;
      background: rgba(30,30,34,.9);
      box-shadow: 0 20px 50px rgba(0,0,0,.4);
      white-space: pre-wrap; word-break: break-word;
    }
    #boot-error .box h2{ margin:0 0 8px 0; font-size:18px }
    #boot-error .box code{ display:block; margin-top:8px; font-size:13px; opacity:.95 }
    noscript{ display:block; text-align:center; margin:20vh auto; font-size:16px }
  </style>
</head>
<body>

  <!-- Fallback content so the page is never completely blank -->
  <div id="app">
    <div class="dash-grid" style="padding: 16px; max-width: 72rem; margin: 0 auto;">
      <div class="card glass"><div class="skeleton"></div><div class="skeleton"></div></div>
      <div class="card glass"><div class="skeleton"></div><div class="skeleton"></div></div>
      <div class="card glass dash-span-2"><div class="skeleton"></div><div class="skeleton"></div></div>
    </div>
  </div>

  <!-- Picker Overlay -->
  <div id="pickerOverlay" aria-hidden="true">
    <div id="pickerBox" role="dialog" aria-modal="true">
      <div class="picker-header">
        <input id="pickerSearch" placeholder="ค้นหา…" inputmode="search" />
        <button class="btn" id="pickerCancel" type="button">ปิด</button>
      </div>
      <div class="picker-list" id="pickerList"></div>
      <div class="picker-actions">
        <button class="btn" id="pickerAdd" type="button" title="เพิ่มใหม่">
          เพิ่ม “<span id="pickerAddText"></span>”
        </button>
      </div>
    </div>
  </div>

  <!-- Toast -->
  <div id="toast" class="toast" role="status" aria-live="polite"></div>

  <!-- Error overlay (shown if JS fails) -->
  <div id="boot-error" role="alert" aria-live="assertive">
    <div class="box">
      <h2>⚠️ App failed to start</h2>
      <div>Open DevTools → <strong>Console</strong> for details. Common causes:
        <ul>
          <li>Incorrect <code>&lt;script src&gt;</code> path (e.g., <code>./js/main.js</code> vs <code>main.js</code>)</li>
          <li>Syntax error in <code>main.js</code></li>
          <li>Blocked by mixed content/CORS</li>
        </ul>
      </div>
      <code id="boot-error-text"></code>
    </div>
  </div>

  <noscript>JavaScript is disabled. Please enable it to use this app.</noscript>

  <!-- Safe-boot guard: shows overlay if main.js fails or renders nothing -->
  <script>
    (function(){
      // 1) Show any runtime error as an overlay
      function showErr(msg){
        var el = document.getElementById('boot-error');
        var code = document.getElementById('boot-error-text');
        if (code) code.textContent = String(msg || 'Unknown error');
        if (el) el.style.display = 'block';
      }
      window.addEventListener('error', function(e){ showErr(e.message + (e.filename?('\n' + e.filename + ':' + e.lineno):'')); });
      window.addEventListener('unhandledrejection', function(e){ showErr((e.reason && (e.reason.stack || e.reason.message)) || String(e.reason)); });

      // 2) After main.js loads, verify that #app has content
      //    If it's still empty after a short delay, show a helpful overlay
      function verifyMount(){
        var app = document.getElementById('app');
        // If your app replaces fallback with real UI, app should have more than skeletons
        // Give it a little time to render.
        setTimeout(function(){
          // Heuristic: if no interactive elements added, assume mount failed
          var hasButtons = app && app.querySelector('.tabs, .toolbar, button[id^="tab-"]');
          if (!app || !hasButtons){
            showErr('App did not render into #app.\nCheck that main.js calls your render/init function and the selector matches (#app).');
          }
        }, 900);
      }
      // Expose for main.js to call when it has successfully mounted
      window.__APP_MOUNTED__ = function(){ /* noop: presence indicates success */ };

      // Trigger verification slightly after main.js
      window.addEventListener('DOMContentLoaded', function(){
        // If main.js calls __APP_MOUNTED__ we skip verify
        setTimeout(function(){
          if (typeof window.__APP_MOUNTED__ !== 'function' || window.__APP_MOUNTED__.called !== true){
            verifyMount();
          }
        }, 1200);
      });
    })();
  </script>

  <!-- IMPORTANT: ensure this path matches your repo structure -->
  <!-- If your JS lives in /js/main.js, change to src="js/main.js" -->
  <script src="main.js" onload="if (typeof __APP_MOUNTED__==='function'){ __APP_MOUNTED__.called=true }" defer></script>
</body>
</html>